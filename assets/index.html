<html>
    <head>
        <meta charset="UTF-8">
        <title>Global Explorer</title>
        <link rel="stylesheet" href="main.css">
        <script src="utils.js"></script>
        <script src="core.js"></script>
        <script src="render.js"></script>
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/showdown/1.9.1/showdown.min.js"
            integrity="sha512-L03kznCrNOfVxOUovR6ESfCz9Gfny7gihUX/huVbQB9zjODtYpxaVtIaAkpetoiyV2eqWbvxMH9fiSv5enX7bw=="
            crossorigin="anonymous"
        ></script>
    </head>
    <body>
        <div id="app" class="visible"></div>
        <div class="account" id="account">
            <div class="info" id="date">Time: - - -</div>
            <div class="credit-card closed">
                <div class="name" id="credit-card-name">Guy Anonymous</div>
                <div class="number" id="credit-card-number">1111 1111 1111 1111</div>
                <div class="chip"></div>
                <div class="logo" id="credit-card-issuer">SHOWYA</div>
            </div>
            <div class="info" id="account-balance">Account balance: -</div>
        </div>
    </body>
    <script>

async function setup() {
    const markdownConverter = new showdown.Converter()
    const render = createContentRenderer("app", {
        markdownTransform: (markdown) => {
            return markdownConverter.makeHtml(markdown)
        }
    })
    const creditCard = createCreditCardControl(
        "account",
        "credit-card-name",
        "credit-card-number",
        "credit-card-issuer",
        "account-balance",
        "date"
    )
    const core = await GlobalExplorer.from_websocket(
        "ws://localhost:8765/",
        () => {
            console.log(core.version)
            console.log(core.player)
            console.log(core.content)
            console.log(core.game)
            creditCard(core.player, core.game)
            render(core.content, (action) => {
                console.log(action)
                core.action(action)
            })
        }
    );
    core.init().then(() => {
        const content = core.content
    })
}
setup()

    </script>
</html>